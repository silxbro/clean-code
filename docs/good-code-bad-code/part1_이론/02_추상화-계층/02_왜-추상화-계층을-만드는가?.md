# 왜 추상화 계층을 만드는가?
<br/>

코드 작성은 복잡한 문제를 계속해서 더 작은 하위 문제로 세분화하는 작업이다. 이것을 설명하기 위해 사용자의 어떤 장치에서 실행되면서 서버에 메시지를 보내는 코드를 작성한다고 가정해보자.
아마도 예제2.1과 같은 코드를 작성할 수 있을 것이다. 코드가 얼마나 단순한지 보라. 단 세 줄이고 다음과 같은 네 가지 간단한 개념만 다루면 된다.

- 서버의 URL
- 연결
- 메시지 문자열 보내기
- 연결 닫기

#### [예제2.1] 서버에 메시지 보내기
```java
HttpConnection connection =
  HttpConnection.connect("http://example.com/server");
connection.send("Hello server");
connection.close();
```
높은 층위에서는 이것이 꽤 간단한 문제처럼 보이고, 실제로 그것에 대한 해결책도 꽤 간단해 보인다. 그러나 이것이 간단한 문제가 아니라는 것은 분명히 알 수 있다.
클라이언트 장치에서 서버로 'Hello server'라는 문자열을 보내는 데는 다음과 같은 엄청나게 복잡한 일이 일어난다.

- 전송할 수 있는 형식으로 문자열 직렬화
- HTTP 프로토콜의 모든 복잡한 동작
- TCP 연결
- 사용자의 장치가 와이파이 혹은 셀룰러 네트워크에 연결되어 있는지 여부 확인
- 데이터를 라디오 신호로 변조
- 데이터 전송 오류 및 수정

이 예는 서버에 메시지를 보내야 한다는 상위 수준의 문제가 있다. 그러나 이를 위해 (위에서 나열한 것 등) 해결해야 할 하위 문제가 많다.
다행스럽게도 다른 개발자들이 이 모든 하위 문제를 이미 해결했다. 문제를 해결했을 뿐만 아니라 그것들을 인식할 필요도 없게 만들었다.

하나의 문제가 있을 때 이 문제와 하위 문제에 대한 해결책이 일련의 층을 형성하고 있는 것으로 생각할 수 있다.
최상위 계층에서는 HTTP 프로토콜이 어떻게 구현되는지 알 필요도 없이 서버에 메시지를 보내는 것에만 신경을 쓰면서 코드를 작성할 수 있다.
이와 비슷하게 HTTP 프로토콜을 구현하기 위한 코드를 작성한 엔지니어는 데이터가 무선 신호에 변조되는 방법에 대해 아무것도 몰라도 문제가 없었을 것이다.
HttpConnection 코드를 구현한 개발자는 물리적인 데이터 전송을 추상적인 개념으로 생각할 수 있었고, 우리 역시 HTTP 연결을 추상적인 개념으로 생각할 수 있다.
이것을 **추상화 계층**(layers of abstraction)이라고 한다. 다음 그림은 서버에 메시지를 보내는 것과 관련해 추상화 계층의 일부를 보여준다.

<img src="https://github.com/silxbro/clean-code/assets/142463332/3b142434-afac-4420-b558-f6038bafaecc" width="450" height="350"/><br/>
- 서버에 메시지를 보낼 때, 다른 개발자가 이미 작성한 하위 문제에 대한 해결책을 재사용할 수 있다.
  간결한 추상화 계층은 상위 수준의 문제를 해결하기 위해 몇 가지 개념만 알면 된다는 것을 의미한다. 

좀 더 일반적으로 말해서 어떤 문제를 하위 문제로 계속해서 나누어 내려가면서 추상화 계층을 만든다면, 같은 층위 내에서는 쉽게 이해할 수 있는 몇 개의 개념만을 다루기 때문에
개별 코드는 특별히 복잡해 보이지 않을 것이다. 소프트웨어 엔지니어로서 문제를 해결할 때 이것이 목표가 되어야 한다.
비록 문제가 엄청나게 복잡할지라도 하위 문제들을 식별하고 올바른 추상화 계층을 만듦으로써 그 복잡한 문제를 쉽게 다룰 수 있다.
<br/>
<br/>
## 1. 추상화 계층 및 코드 품질의 핵심 요소
깨끗하고 뚜렷한 추상화 계층을 구축하면 코드 품질의 네 가지 핵심 요소를 달성할 수 있다. 그 이유는 다음과 같다.

### [가독성]
개발자들이 코드 베이스에 있는 코드의 모든 세부 사항을 이해하는 것은 불가능하지만 몇 가지 높은 계층의 추상화를 이해하고 사용하기는 상당히 쉽다.
깨끗하고 뚜렷한 추상화 계층을 만드는 것은 개발자가 한 번에 한두 개 정도의 계층과 몇 개의 개념만 다루면 된다는 것을 의미한다. 따라서 코드의 가독성이 크게 향상된다.

### [모듈화]
추상화 계층이 하위 문제에 대한 해결책을 깔끔하게 나누고 구현 세부 사항이 외부로 노출되지 않도록 보장할 때,
다른 계층이나 코드의 일부에 영향을 미치지 않고 계층 내에서만 구현을 변경하기가 매우 쉬워진다.
HttpConnection 예에서 물리적 데이터 전송을 처리하는 시스템은 모듈화되어 있을 가능성이 크다.
사용자가 와이파이를 사용하는 경우 한 모듈이 사용되고, 셀룰러 네트워크에 있는 경우 다른 모듈이 사용된다.
상위 수준의 코드에서는 이러한 다양한 상황에 대처하기 위해 어떤 특별한 작업을 수행할 필요가 없다.

### [재사용성 및 일반화성]
하위 문제에 대한 해결책이 간결한 추상화 계층으로 제시되면 해당 하위 문제에 대한 해결책을 재사용하기가 쉬워진다.
그리고 문제가 적절하게 추상적인 하위 문제로 세분화되면, 해결책은 여러 가지 다른 상황에서 유용하게 일반화될 가능성이 크다.
HttpConnection 예에서 TCP/IP 및 네트워크 연결을 처리하는 시스템의 대부분은 웹소캣(WebSockets)과 같은 다른 유형의 연결에 필요한 하위 문제를 해결하는 데도 사용될 수 있다.

### [테스트 용이성]
신뢰할 수 있는 코드를 작성하고자 한다면, 각 하위 문제에 대한 해결책이 견고하고 제대로 작동하는지 확인해야 한다.
코드가 추상화 계층으로 깨끗하게 분할되면 각 하위 문제에 대한 해결책을 완벽하게 테스트하는 것이 훨씬 쉬워진다.
